<!DOCTYPE html>
<html>
  <head>
  	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
		<script src="/js/jquery.collapse.js"></script>
		<script type="text/javascript" src="/js/shCore.js"></script>
		<script type="text/javascript" src="/js/shBrushPython.js"></script>
		<script type="text/javascript" src="/js/shBrushSql.js"></script>
		<script type="text/javascript" src="/js/shBrushPlain.js"></script>

  	<meta charset="utf-8">
  	<meta name="viewport" content="width=device-width, initial-scale=1">
  	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      	
  	<title>Why Does Country Music All Sound the Same?</title>
  	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
  	<link rel="icon" type="image/png" href="/img/profile.png">
  	<link rel="stylesheet" href="../style.css">
  	<link href="/css/shCore.css" rel="stylesheet" type="text/css" />
		<link href="/css/shThemeDefault.css" rel="stylesheet" type="text/css" />
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css">

    <script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

      	
  	<script type="text/javascript" src="//use.typekit.net/sjt4iho.js"></script>
 		<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
      
  	<script src="../node_modules/chart.js/dist/Chart.js"></script>
		<script src="../js/jquery-1.11.0.js"></script>

		
      	<style> 
        /***** BASE STYLES *****/ 
        
        code {
		  color: inherit;
		  background-color: rgba(0, 0, 0, 0.04);
		}
		 pre:not([class]) {
		    background-color: white;
		  }
        blockquote {
          font-size: 21px;  
          margin: 90px 0 90px 0; 
          font-family: proxima-nova,proxima-nova,'proxima nova','helvetica neue',helvetica,sans-serif
        }

        cite {
          display: block;
          text-align: right;
          margin-top: 15px;
        }

        .firstcharacter { 
          float: left; 
          font-size: 54px; 
          line-height: 60px;  
          padding-right: 7px;  
        }  

        .fa {
          cursor: pointer;
        }  

        /** Navigation **/ 
          .main-navigation, .nav-toggle  {
            display: none;
          }

          #desktopNav	{
            position: absolute;
            height: 100%;
            background-color: #233140;
            top: 0;
            left: 0;
            z-index: 9999;
            width: 230px;
          }

          #desktopNav.fixedElement {
            position: fixed;
            height: 100%;
            top: 0;
            left: 0;
          } 


        nav ul li a {
          font-family: proxima-nova,proxima-nova,'proxima nova','helvetica neue',helvetica,sans-serif;
          color: #E8E8E8;
          text-decoration: none;
          transition: color 0.3s;
          letter-spacing: 1px;
        } 

        nav ul li a:hover {
          color: #C7C7C7;
        } 

         .secondUL li {
            padding: 10px 10px 0 0;
          }

          .navHeadline {
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600; 
            color: #4C91B8;
          }

        .navSection {
            margin-bottom: 20px;
          } 

          .nav-toggle {
            transform: translateY(-100%);
            overflow: hidden;
            height: 50px;
            background: rgba(29, 55, 69, 0.9);
            transition: transform 0.9s ease;
            color: #E9A857;
            font-size: 20px;
          } 

         #bootstrap-overrides  .nav-toggle.show {
            height: 50px;
            transform: translateY(0%);
            transition: transform 0.9s ease;
          }

         #bootstrap-overrides  .main-navigation {
            position: fixed;
            top: 0;
            left:0; 
            width: 270px;
            height: 100%;
            background: rgba(29, 55, 69, 0.9);
          }

        

        

        .center {
          max-width: 1170px;
          margin: 0 auto;
          position: relative;
        }

        .img-center{
          margin-left: 115px;
          margin-top: 40px;
          margin-bottom: 40px;
        }
        .wrapper {
          margin-left: 230px;
        } 	  
          
        .left {
          width: 50%;
          float:left;
        }

        .right {
          position: relative; 
          float:left;
          width: 50%;
        }  

        .introLetterDiv, .outroLetterDiv {
            background-color: #fff; 
            padding: 70px;  
            text-align: left; 
            max-width: 600px; 
            margin: 0 auto;
        }

        .introLetterDiv h3 {
            font-size: 21px;
            font-weight: 400;
            margin-bottom: 35px;
            margin-top: -20px;
        }

        .introLetterDiv .signature {
            text-align: right;
        } 

        .introLetterDiv .signatureBox {
            text-align: center;
            display: inline-block;
        } 

        .introLetterDiv p, .outroLetterDiv p {
          max-width: 600px;
          margin-left: 0;
        } 

        .main_title {
          text-align: center;
        }  

        .letterOrange {
          width: 85px; 
          height:7px; 
          display: block; 
          background-color: #E9A857; 
          margin:40px 0;" 
        } 

        .firstOrangeBar {
            background-color: #E9A857;
            display: block; 
            height: 254px; 
            width: 27px;
        }

        .headerThree h2 {
          margin-top: 30px;
          display: inline-block;
          width: 450px;
          vertical-align: top;
        }

        #three .thickOrangeLine {
          position: absolute;
          top: 160px;
        }

        .bulkUpImage {
          margin-left: 22%; 
        }

        .nasties {
           width: 60%;
           position: absolute;
           top: 50px;
        }

        .badHabbit {
          width: 300px;
          line-height: 94px;
          display: inline-block;
          margin-top: 0.83em;
        }  

        .thickOrangeLine { 
          width: 82px; 
          height: 27px; 
          background-color: #E9A857; 
          position: absolute;
          top: 50px;
        }

        .learnMobile {
            display: none;
        }

        

        /** Exeptions **/
        article#one {
            margin-bottom: 50px;
          	padding: 0;
        }
          
        article#two {
            padding-top: 0
        } 
          
        article#four h2 {
            margin-top:.5em;
        } 
          
        article#eight .quote {
            margin-top: 30px 0 75px 0;
        } 
          
        article#eight .center .left, article#six .center .left {
            margin-right: 5%;
        } 
          
        article#eight .right, article#six .right {
            width: 45%;
        }
          
        article#eight .right img, article#six .right img {
            width: 100%;
        }  

        /*** Footer ***/
          footer {
            background-color: #1D3745; 
            width: 100%; 
            position: absolute; 
            z-index: 9999; 
            bottom: -70px;
          } 
          
           footer p {
            float: left;
          }

          .mktoForm {
            width: auto!important;
          }

          .bulkUpImage {
          	width: 46%;
          }	
          
          /***** Desktop Small *****/
          @media screen and (max-width: 1441px) {

            .center {
                max-width: 970px;
            }

            .nasties {
              top: 165px;
              width: 60%;
            }

            .container .sideText1, .container .sideText2, .container .sideText3, .container .sideText4, .container .sideText5 {
              margin-left: 60px;
              margin-right: auto;
            }

            .container .sideText1 p, 
.container .sideText2 p, .container .sideText3 p, .container .sideText4 
p, .container .sideText5 p {
              margin-left: 0;
            }

            .thickOrangeLine {
              display: none;
              top: 30px;
              width: 43px;
            }

            .bulkUpImage {
              width: 65%;
            }
          }  

          @media screen and (max-width: 1225px) {
            .center {
              max-width: 870px;
            }

            .bulkUpImage {
              width: 78%;
            }
          }

          @media screen and (max-width: 1170px) {
            .center {
              max-width: 770px;
            }

            footer {
              display: none;
            }

            .bulkUpImage { 
              width: 100%;
              margin-left: 10%;
            }
          }   

          @media screen and (max-width: 1024px) {

            .learnDesktop {
              right: -155px
            }

            .center {
              max-width: 670px;
            }
          }  

        

          
        </style>
  	<link rel="shortcut icon" href="/img/profile.png" type="image/x-icon" >
<link rel="icon" href="/img/profile.png" type="image/x-icon" >


<style>.mktoGen.mktoImg {display:inline-block; line-height:0;}</style>
  	</head>
  	<body id="bootstrap-overrides">
<style type="text/css"> 
#bootstrap-overrides hr.star-light {  
  border-color: #18BC9C;
	margin-left: auto;
    margin-right: auto;}
 #bootstrap-overrides  hr.star-light:after {
background-color: white;
color: #2C3E50;}
canvas {
    padding-left: 0;
    padding-right: 0;
    margin-left: auto;
    margin-right: auto;
    display: block;
    width: 90px;
}
</style>
  	</body>
	<body class="layout" id="bodyId">
      	
		<div class="extraWrapper" style="position:relative;">	
			<!-- DESKTOP FIXED NAV -->
         	<div id="desktopNav">
            <div style="position: relative; height: 100%;">
               <nav>
                  <ul class="firstUL">	
                    <li class="navSection"><span class="navHeadline"><a style="color: #4C91B8;" href="/">Home</a></span>
                      <ul class="secondUL"> 
                          <li><a href="/#portfolio">Portfolio</a></li>
                          <li><a href="/blog/">Blog</a></li>
                      </ul>
                    </li>
                    <li class="navSection"><span class="navHeadline">Contents</span>
                      <ul class="secondUL">	
                          <li><a href="/examples/SmoothPageScroll/#one">Hypothesis</a></li>
                          <li><a href="/examples/SmoothPageScroll/#two">Getting Chords</a></li>
                          <li><a href="/examples/SmoothPageScroll/#three">Analyzing Chords</a></li>
                          <li><a href="/examples/SmoothPageScroll/#four">Getting Country Music Lyrics</a></li>
                          <li><a href="/examples/SmoothPageScroll/#five">Analyzing Lyrics</a></li>
                          <li><a href="/examples/SmoothPageScroll/#six">Generating Original Lyrics</a></li>
                          <li><a href="/examples/SmoothPageScroll/#seven">Conclusion</a></li>
                          <!--<li><a href="/examples/SmoothPageScroll/#eight">Take Risks</a></li>-->
                          <li><a href="/examples/SmoothPageScroll/#forecast">Other Projects</a></li>
                      </ul>
                    </li>
                    
                  </ul> 
              </nav> 
            </div>
          	</div>
	<div class="wrapper" id="header">
<p><br></p>
<h1 align="center" style = "margin: 0;"> Why All Country Music Sounds the Same</h1>
<header>
    <hr class="star-light">
</header>
<ul><p><big><i>"Country music is just three chords and the truth"</i></big></p></ul>
<ul><ul><p><big>- <a target= "_blank" href="https://en.wikipedia.org/wiki/Harlan_Howard">Harlan Howard</a></big></p></ul></ul>
<hr>
</div>
          	<div class="wrapper">
				<!-- Resolution 1 -->
				<article id="one">
      				<div class="center">
              			<div>
              				<h2 class="badHabbit">Hypothesis</h2>
              				<p>I hypothesize that all country music sounds the same because of <i>similiarities in the components of songs</i>. Specifically, because many country music songs are composed with vocals and guitar, the way the guitar is played and the kinds of lyrics used in the songs may be key components in determining whether or not all country music does sound similar. The way the guitar is played can be determined by the <a target="_blank" href = "https://en.wikipedia.org/wiki/Chord_progression">chord progression</a>, and I hypothesize that many country songs all use the same chord progession, whereas in other genres of music, there will be a greater variation of the chord progressions used in songs. I also suspect that the lyrics have some similarity in the words used and a <a target="_blank" href = "https://en.wikipedia.org/wiki/Naive_Bayes_classifier">naive-Bayes analysis</a> may be suitable.</p>
<p>The complete code can be found on github <a target="_blank" href="https://github.com/moocarme/Coding-Samples/tree/master/Python-Webscraping">here</a>.</p>
              			</div>
              			<div class="left"></div>
      				</div>  
    			</article>  
    			<!-- End Resolution 1 -->
    
				<!-- Resolution 2 -->
				<article id="two">  
          			
         	 			<div class="center">    
            				<h2>Method</h2>  
								<p>A chord progression is the different chords used in songs, as well as the order in which they are used. For example Pearl Jam's <a target="_blank" href = "https://www.youtube.com/watch?v=2z0cKtSlHOU">'Elderly woman...'</a> uses a chord progression D C G G for the much of the verse and chorus. Both the notes used and their respective order is needed. The assumption that the guitar plays the characteristic 'sound' of the song and can be infered from the data gained from the chord progression of the guitar.</p>  
								<p>A python webscraper mines guitar tabluture from the internet, specifically <a target="_blank" href="https://ultimate-guitar.com">ultimate-guitar.com</a> and reads them to obtain the chords used in songs. The python code retrives the chords that users of the site have entered. Because the guitar tablature is user submitted, only 5 star rated tablatures are used in standard tuning, for greatest accuracy. A 5 star rating is achieved when all users of the tablature rate the tab as 5-star. Mining the tablature for data on the various chord progressions played in songs, the end goal would be analyze different genres of music to show that country music shows less variation in the chords and chord progressions used compared to other genres of music.</p>

<h3>Guitar tablature Example</h3>
<div data-collapse>
      <h4> See here &#9660;</h4>
 		<div>
		<p>Below is an example of typical guitar tablature from ultimate-guitar.com</p>
		<pre class="brush: sql">Band- Metallica
Song- TuesdAYS gONE

  A5                   E5                   F#5                   D
      x 0 2 2 x x          0 2 2 x x x          2 4 4 x x x          x x 0 2 3 2

         Dsus4                Dsus2                  G                   F#m
      x x 0 2 3 3          x x 0 2 3 0          3 2 0 0 3 3          2 4 4 2 2 2

         GIII
      3 5 5 4 3 3

Gtr I (Eb Ab Db Gb Bb Eb) - 'acoustic'
Gtr II (Eb Ab Db Gb Bb Eb) - 'dobro'
Gtr III (Eb Ab Db Gb Bb Eb) - 'acoustic'
Gtr IV (Eb Ab Db Gb Bb Eb) - 'acoustic'

 Intro
  Slowly H.=50
                   A5                                 E5
 3/4
  Gtr I
                    |           |                      |    ||
                    /           /                      /    //

  Gtr II
                                                       ~~
|-------|-------||-----------|----------------------|------------|
|-------|-------||-14--------|-14------14b16r=(14)--|-12---------|
|-------|-------||-----------|----------------------|------------|
|-------|-------||-----------|----------------------|------------|
|-------|-------||-----------|----------------------|------------|
|-------|-------||-----------|----------------------|------------|
|
| Gtr III
|                                                      ~~
|-------|-------||-----------|----------------------|------------|
|-------|-------||-----------|----------------------|------------|
|-------|-------||-11--------|-11b13r=(11)----------|--9---------|
|-------|-------||-----------|----------------------|------------|
|-------|-------||-----------|----------------------|------------|
|-------|-------||-----------|----------------------|------------|
|
| Gtr IV
|-------|-------||-----------|----------------------|------------|
|-------|-------||-----------|--2-------------------|------------|
|-------|-------||--------2--|----------2-----------|------------|
|-------|-------||-----2-----|------------------2---|--------2---|
|-------|-------||--0--------|----------------------|-----2------|
|-------|-------||-----------|----------------------|--0---------|


                    F#5                                   D
  |        |  |      |         ||    |        |     |     |  | || |
  /        /  /      /         //    /        /     /     /  / // /

                        ~~~~~~~                           ~
|-----------------|----------------|--------------------|----------|
|----12b13r=(12)--|-12-10-(10)-----|----10b12r====(10)--|-7--------|
|-----------------|----------------|--------------------|----------|
|-----------------|----------------|--------------------|----------|
|-----------------|----------------|--------------------|----------|
|-----------------|----------------|--------------------|----------|
|
|                    ~~                                   ~
|-----------------|----------------|--------------------|----------|
|-----------------|----------------|--------------------|----------|
|-----------------|----------------|--------------------|----------|
|-----9b10r==(9)--|--7-------------|----------7b9r=(7)--|-4--------|
|-----------------|----------------|--------------------|----------|
|-----------------|----------------|--------------------|----------|
|
|                    PM---------------------------|
|-----------------|----------------|--------------------|----------|
|-----------------|----------------|--------------------|-------3--|
|-1---------------|----------------|-2------------------|----2-----|
|-----2-----------|-------------4--|-----4--------------|-0--------|
|-------------2---|---------4------|----------------4---|----------|
|-----------------|--2-------------|--------------------|----------|

		</pre>
		</div>
	</div>
	<p><br></p>
	<p>The python webscraper built goes through all the tabs of a particular genre and grabs all the chords played in the song. The chord progression is obtained by simply finding the 4-chord combination that is most common. This chord progression is then added to an SQL database, along with the artist name, song title genre and subgenre. An example of sub-genre to a genre is bluegrass, which is a sub-genre to country. This relationship was taken from exploring how <a target="_blank" href="https://www.ultimate-guitar.com/">ultimate-guitar.com</a> specifies. Once database of all the chord progressions is obtained, a subsection can be queried from the list, i.e. accouding to subgenre, and it is sorted and plotted. A cumulative distribution is also obtained from the sorted list and is useful for determining global variation.</p>
	<p><br></p>
	<h3>Python script - Chords Webscraper</h3>
<div data-collapse>
      <h4> See here &#9660;</h4>
 		<div>
		<pre class="brush: python"># -*- coding: utf-8 -*-
"""
Created on Sun Mar 20 12:12:07 2016
Updates on Sun Apr 17
Added SQL database on July 10th

@author: matt
"""
# = Import packages
import requests
from lxml import html
from lxml.etree import tostring
import sqlite3
import collections
import re

# = Helper Functions =========================================================

def removeTags(string):
    '''
    Function to remove html tags
    '''
    return re.sub('<[^<]+?>', '', string)
    
def getArtist(webTree):
    '''
    Function to get the artist name from html
    '''
    ArtistLoc = webTree.find_class('t_autor')
    ArtistStrList = [tostring(track, with_tail=False) for track in list(ArtistLoc[0].iter('a'))]
    Artist = removeTags(ArtistStrList[0])
    return Artist
    
def getTrack(webTree):
    '''
    Function to get the track name from html
    '''
    title = webTree.find_class('t_title')
    Tracklist = [tostring(track, with_tail = False) for track in list(title[0].iter('h1'))]
    Track = removeTags(Tracklist[0])
    return Track

def getChordsList(webTree):
    '''
    Function to get a list of chords from html
    '''
    tabContentClass = webTree.find_class('js-tab-content')
    try:
        chordsList = list(tabContentClass[0].iter('span')) # starts at element 0
        chords = [tostring(chord, with_tail = False).strip('</span>') for chord in chordsList]
    except IndexError:
        chords = []
    return chords
    
def getChordsArtistTrack(url):
    '''
    Function to get chords from a webpage in str format
    '''
    webPage = requests.get(url)
    webTree = html.fromstring(webPage.content)
    Artist = getArtist(webTree)
    Track = getTrack(webTree)
    Chords = getChordsList(webTree)    
    return Artist, Track, Chords 

def getGenreTree(genrekey, page):
    '''
    Function to get xml tree given the genre
    '''    
    if type(page) == int:
        page = str(page)
    theURL = 'https://www.ultimate-guitar.com/search.php?type[2]=300&type2[0]=40000&rating[4]=5' \
        + '\&tuning[standard]=standard&genres[0]=' + str(genrekey)+ '&page=' + page \
        + '&view_state=advanced&tab_type_group=text&app_name=ugt&order=myweight'
        
    pageBand = requests.get(theURL)
    return html.fromstring(pageBand.content)
    

def getChordProg(chordList, progLen = 4):
    '''
    Function to get the most common chord progression in a list
    '''
    progs4 = [''.join(chordList[i:i+progLen]) for i in range(len(chordList)-progLen)]
    try:
        chordProg = collections.Counter(progs4).most_common(1)[0][0]
    except IndexError: # If there are no chords
        chordProg = ''
    return chordProg
    
def getGenreDict():
    '''
    Function to get all the genres and output to a dict of dicts where the keys 
    to the outer dict is the main genre the values are dicts, with the inner
    values being the sub genre
    '''
    url = 'https://www.ultimate-guitar.com/advanced_search.html'
    pageUrl = requests.get(url)
    webTree = html.fromstring(pageUrl.content)
    Main = webTree.find_class('b')
    MainGenreList = list(Main[2].iter('optgroup'))
    GenreDict = {}
    for Genre in MainGenreList:
        GenreStr = tostring(Genre, with_tail = False)
        g1 = str.split(re.sub('&#13;\s+','\n',removeTags(GenreStr)),'\n')[1:-1]
        MainGenre = g1[0]
        GenreInd_complete = re.findall(r'\d+',GenreStr)
        if len(GenreInd_complete)>4:
            GenreInd = GenreInd_complete[2:-2:2]
        else:
            GenreInd = GenreInd_complete[2]
        subGenreDict = dict(zip(g1[1:], GenreInd[1:]))
        if bool(subGenreDict):
            GenreDict[MainGenre] = subGenreDict
        else:
            GenreDict[MainGenre] = dict([(MainGenre, GenreInd[0])])
    return GenreDict
# ============================================================================

def main()
    # = Set up SQL 
    conn = sqlite3.connect('chordProgdb2.sqlite')
    cur = conn.cursor()
    cur.executescript('''
    /*
    Uncomment out the bottom section is want to reset the tables
    */
  
    /*
    DROP TABLE IF EXISTS Artist;
    DROP TABLE IF EXISTS ChordProg;
    DROP TABLE IF EXISTS Genre;
    DROP TABLE IF EXISTS Song;
  
    CREATE TABLE Artist (
        id  INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT UNIQUE,
        name    TEXT UNIQUE
    );
  
    CREATE TABLE ChordProg (
        id  INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT UNIQUE,
        prog   TEXT UNIQUE
    );
  
    CREATE TABLE Genre (
        id  INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT UNIQUE,
        name    TEXT UNIQUE
    
    );

    CREATE TABLE Song (
        id  INTEGER NOT NULL PRIMARY KEY 
            AUTOINCREMENT UNIQUE,
        title TEXT,
        artist_id INTEGER,
        chordProg_id  INTEGER,
        genre_id INTEGER,
        subgenre_id INTEGER
    );
    */
    ''')

    # ============================================================================


    allGenresDict = getGenreDict()
    #to find all genres: allGenresDict.keys()
    
    mainGenre = 'Alternative'
    genresDict = allGenresDict[mainGenre]
    
    cur.execute('''INSERT OR IGNORE INTO Genre (name) 
        VALUES ( ? )''', (mainGenre, ) )
    cur.execute('SELECT id FROM Genre WHERE name = ? ', (mainGenre, ))
    main_genre_id = cur.fetchone()[0]   
    
    page = '1' # start at page 1, in str format as will be added to html str
    
    for genre, genrekey in genresDict.iteritems():
        # = Get xml tree for first page
        tree1 = getGenreTree(genrekey, page)
        pages = tree1.find_class('paging')
        try: 
            maxPage = len(list(pages[0].iter('a'))) # see what the max number of pages is
            print('Max Page: '+ str(maxPage))
        except IndexError:
            break
        # = Grab song links on the first page
        songs = tree1.find_class('song result-link')
        songLinks = []
        for i in songs:
            songLinks.append(i.get('href'))        
        
        # = Iterate through the remaining pages and add song links
        for i in range(maxPage -1):
            looppage = i + 2
            looptree = getGenreTree(genrekey, str(looppage))
            loopsongs = looptree.find_class('song result-link')
            for song in loopsongs:
                songLinks.append(song.get('href'))
        
        print('No of tabs: ' + str(len(songLinks)))
        
        cur.execute('''INSERT OR IGNORE INTO Genre (name) 
            VALUES ( ? )''', (genre, ) )
        cur.execute('SELECT id FROM Genre WHERE name = ? ', (genre, ))
        subgenre_id = cur.fetchone()[0]
             
        
        progLen = 4
        for i in songLinks:
            Artist, Song, Chords = getChordsArtistTrack(i)
            chordProg = getChordProg(Chords, progLen)
            
            cur.execute('''INSERT OR IGNORE INTO Artist (name) 
                VALUES ( ? )''', ( Artist, ) )
            cur.execute('SELECT id FROM Artist WHERE name = ? ', (Artist, ))
            artist_id = cur.fetchone()[0]    
            
            cur.execute('''INSERT OR IGNORE INTO ChordProg (prog) 
                VALUES ( ? )''', (chordProg, ) )
            cur.execute('SELECT id FROM ChordProg WHERE prog = ? ', (chordProg, ))
            chordProg_id = cur.fetchone()[0]
            
            cur.execute('''INSERT OR REPLACE INTO Song
                (title, artist_id, genre_id, subgenre_id, chordProg_id) 
                VALUES ( ?, ?, ?, ?, ? )''', 
                ( Song, artist_id, main_genre_id, subgenre_id, chordProg_id, ) )
            conn.commit()
        
if __name__=='__main__':
    main()</pre>
		</div>
	</div>
	<p><br></p>
	<h3>Database Entity Relationship Diagram</h3>
	<div data-collapse>
	      <h4> See here &#9660;</h4>
 		<div>
			<img class="img-responsive" src="../img/riffcode_figs/dbschema.png"  height="500" width="500">
		</div>
	</div>
	<p><br></p>
	<h3>SQL Query Example</h3>
	<h4>Accessing top 10 most frequent Americana chords</h4>
	<h4>Query</h4>
	<ul><li><p>Joins the appropriate tables in the database.</p></li></ul>
	<ul><li><p>Filter by subgenre.</p></li></ul>
	<ul><li><p>Group by chord progression.</p></li></ul>
	<ul><li><p>Order by their total count, descending.</p></li></ul>
	<ul><li><p>Select appropriate columns.</p></li></ul>
	<div data-collapse>
	      <h4> See here &#9660;</h4>
 		<div>
 			<pre class = "brush: python"># -*- coding: utf-8 -*-
"""
Spyder Editor

Created on July 10th
"""

import sqlite3
conn = sqlite3.connect('chordProgdb2.sqlite')
cur = conn.cursor()

def main():
	cur.execute('''
	SELECT chord.prog, COUNT(*)
	FROM Song AS master
	LEFT JOIN Genre AS subgenre_tbl ON subgenre_tbl.id = master.subgenre_id
	LEFT JOIN Genre ON genre.id = master.genre_id
	LEFT JOIN ChordProg AS chord ON chord.id = master.chordProg_id
	WHERE subgenre_tbl.name = 'Americana'
	GROUP BY chord.prog
	ORDER BY COUNT(*) DESC
	LIMIT 10
	;
	''')

	top10Americana= cur.fetchall()
	conn.commit
	print(list(top10Americana))

if __name__=="__main__":
	main()

 			</pre>
 			<pre class="brush: plain">out: [(u'DGDG', 7), (u'CGAmC', 6), (u'GCGC', 6), (u'GEmGEm', 6), (u'B7EAE', 5), (u'CFCF', 5), 
(u'EEEE', 5), (u'DADA', 4), (u'DEmCG', 4), (u'DGCG', 4)]</pre>
		</div>
	</div>
	<p>Though the data is not very big in size it may be a good question to ask why the data is even in a SQL database in the first place, since the total data is only a few megabytes, and will easily fit in memory. My reason is that it is a good habit I have developed, to load, save, and access SQL tables in databases. Moreover, adding to the database can easily be done and is standaradized using the entity relationship diagram (ERD), data can be added from other data sources, and is the database can be incorporated to other projects easily. </p>
	<p><br></p>

            				<div class="left">
              					<div class="container">
                					<div class="sideText2">
                  						<span class="line"></span>
                  						<p></p>
                					</div>
              					</div>
              					
            				</div>   
         				</div>
         			  
      			</article>
      			<!-- End Resolution 2 -->
    
	  			<!-- Resolution 3 -->
	  			<article id="three" style="background-color:#f7f7f7;">
          			<div class="center">
          				<p><br></p>
        				<h2>Results</h2>
              				<p><br></p>
        				<script>
						    var myChart_chordProg = new Chart({...})
						</script>
						<canvas id="myChart_chordProg" width="60%" height="100%"></canvas>
						<script>

						var ctx = document.getElementById("myChart_chordProg");
						ctx.width = 200;
						ctx.height = 100;
						var randomColorFactor = function() {
						            return Math.round(Math.random() * 255);
						        };
						var randomColor = function() {
						            return 'rgba(' + randomColorFactor() + ',' + randomColorFactor() + ',' + randomColorFactor() + ',.7)';
						        };
						var myChart = new Chart(ctx, {
						    type: 'bar',
						    data: {
						        labels: ['GDCG', 'CGAmF', 'DCGD', 'CGDC', 'DAGD', 'CGCG', 'GDEmC', 'DGDG', 'DGDC', 'DAEmG', 'AmCGAm', 'GAmCG', 'GCGD', 'DABmG', 'GDAG', 'CGAmC', 'GAmFG', 'GFCG', 'EmCDG', 'DGDCadd9'],
						        datasets: [{
						            label: 'Count',
						            data: [319, 205, 193, 186, 180, 176, 175, 157, 147, 147, 131, 114, 109, 108, 106, 104, 98, 97, 96, 96],
						            backgroundColor: 'rgba(24, 188, 156, 0.6)',
						            borderColor: 'rgba(9, 74, 61, 1)',
						            borderWidth: 2
						        }]
						    },
						    options: {
						    	title: {
						            display: true,
						            text: 'Top 20 Chord Progressions used in Country Music',
						            fontSize: 30
						        },
						        scales: {
						            yAxes: [{
						                ticks: {
						                    beginAtZero:true
						                },
						                scaleLabel: {
						        			display: true,
						        			labelString: 'Count',
						        			fontSize: 30
						      			}
						            }],
						            xAxes: [{
						                scaleLabel: {
						        			display: true,
						        			labelString: 'Chord Progression',
						        			fontSize: 30
						      			}
						            }]
						        }
						    }
						});
						</script>
						<p><br></p>
						<script>
						    var myChart_chordProgcdf = new Chart({...})
						</script>
						<canvas id="myChart_chordProgcdf" width="800%" height="600px"></canvas>
						<script src = "../riffCode/chordProg_cdf.js"></script>
						<p><br></p>
						<p> <br> We can see that the many of the chord progressions used in country music include the chords G, C, and D. And notably the highest used chord proression, "GDCG", is used more than 50% more that the following most common chord porgression. However, if we look at the variation of chord progressions, seen in the cumulative distribution function, country music does not appear to show any less variation than other genres. </p>
						<p> If we look at the count of each chords, i.e., in all the songs count the total instance of particluar chords, this may tell us more. This can be done by aggregating and summing all the chords from all the tabs.<br></p>
						<p><br></p>
						<script>
						    var myChart_chords = new Chart({...})
						</script>
						<canvas id="myChart_chords" width="150" height="150"></canvas>
						<script>
						var ctx = document.getElementById("myChart_chords");
						ctx.width = 200;
						ctx.height = 100;
						var randomColorFactor = function() {
						            return Math.round(Math.random() * 255);
						        };
						var randomColor = function() {
						            return 'rgba(' + randomColorFactor() + ',' + randomColorFactor() + ',' + randomColorFactor() + ',.7)';
						        };
						var myChart = new Chart(ctx, {
						    type: 'bar',
						    data: {
						        labels: ['G', 'C', 'D', 'A', 'F', 'Am', 'Em', 'E', 'Bm', 'B', 'Dm', 'Cadd9', 'Bb', 'F#m', 'C#m', 'D7', 'Em7', 'F#', 'A7', 'E7'],
						        datasets: [{
						            label: 'Usage (%)',
						            data: [19.339349908243044, 13.529751879132204, 13.388974081801955, 7.388320470600066, 6.083611956057216, 5.869931370823801, 5.26408406445612, 4.152945021242364, 2.1166947384298247, 2.089041956811383, 1.6868196787249552, 1.2292918374016442, 1.1815279418788809, 1.096055707785515, 0.9326529073129037, 0.9024862364564217, 0.7365695467457704, 0.5932778601774806, 0.5857361924633601, 0.5781945247492396],
						            backgroundColor: 'rgba(24, 188, 156, 0.6)',
						            borderColor: 'rgba(9, 74, 61, 1)',
						            borderWidth: 2
						        }]
						    },
						    options: {
						    	title: {
						            display: true,
						            text: 'Top 20 Chords Used in Country Music',
						            fontSize: 30
						        },
						        scales: {
						            yAxes: [{
						                ticks: {
						                    beginAtZero:true
						                },
						                scaleLabel: {
						        			display: true,
						        			labelString: 'Usage (%)',
						        			fontSize: 30
						      			}
						            }],
						            xAxes: [{
						                scaleLabel: {
						        			display: true,
						        			labelString: 'Chord',
						        			fontSize: 30
						      			}
						            }]
						        }
						    }
						});
						</script>
						<p><br></p>
						<script>
						    var myChart_chordcdf = new Chart({...})
						</script>
						<canvas id="myChart_chordcdf" width="800%" height="600px"></canvas>
						<script src = "../riffCode/chord_cdf.js"></script>
						<p><br></p>
						<p>
						We find that Chords involving variations of G, C, and D are very popular in country music and those three chords account for about 45% of the total chords, if we look at the top 8 chords (G, C, D, A, F, Am, Em, E) they account for almost 75%. For context there are over 800 various chord combinations (see: <a target="_blank" href = "https://tabs.ultimate-guitar.com/m/misc/all_the_chords_crd.htm">here</a>). So we can see how these 8 chords and their various combinations can lead to music that may sound similar. </p>
						<p>When we compare the variation to other genres we can see that country music stands out with little variation in the chords used. From the previous cumulative distribution function we found that the variation of chord progressions is on par with other genres, but from this cumulative distribution function we find that the variation in actual chords is small. <big><b><i>Country music uses the same chords in many different combinations</i></b></big>. This may explain why many country music songs sound similar.</p>
						<p><br></p>
						<h4>Discussion</h4>
						<p>
						One issue I came across when scraping the website is that ultimate-guitar.com only allows 500 search results, yet there are over 20,000 5-star rated chord tabs for some of the genres, separating by sub genre, or even by artist may lead to a greater number of tabs to be processed and so trends may become clearer. This 500 search limit is probably for the user expereince, since I'm assuming no one want to search manually through 20,000 results. 500 a happy medium that is small enough to search manually through, yet large enough to provide good and varied results in the search.</p>
						<hr>
						<ul><p><big><i>"Three chords and the truth - that's what a country song is"</i></big></p></ul>
						<ul><ul><p><big>- <a target="_blank" href="http://willienelson.com/">Willie Nelson</a></big></p></ul></ul>
						<hr>
            			<div class="left"> 
          				</div>   
       				</div>    
      			</article>
     			<!-- End Resolution 3 -->
      
    			<!-- Resolution 4 -->
    			<article id="four">
    				<div style="position: relative;">
      					<div class="center">  
          					<header>
							    <hr class="star-light">
							</header>
							<h1>Country Music Lyrics</h1>
							<p><br></p>
							<h2>Getting Country Music Lyrics</h2>
							<p>The hypothesis that country music sounds similar due similarity of the lyrics can also be examined. The country music lyrics are also scraped from the website <a target="_blank" href="http://www.anycountrymusiclyrics.com">www.anycountrymusiclyrics.com</a>. The scraper goes through all the songs on the website, and pulls the main text, which are the lyrics. Following, the lyrics are cleaned up, by converting them all to lowercase, removing punctuation and any extraneous spaces, and put into a list of lists, the outer list is for the various songs, and the inner list contains the words for each song, or a complete corpus. The list is then saved using the python pickle function, since the scraping takes about 35 minutes to run in total. This process was in general easier to scrape than the guitar tablature since there is more of a standard to submitting lyrics opposed to guitar tablature.</p> 

							<h3>Python script - Country Lyric Webscraper</h3>
							<div data-collapse>
	      <h4> See here &#9660;</h4>
 		<div>
 			<pre class = "brush: python"># -*- coding: utf-8 -*-
"""
Created on Sat Jul  2 16:49:11 2016

@author: matt-666
"""
import urllib
from bs4 import BeautifulSoup, SoupStrainer
import string
import re
import pickle

# = Helper Functions =========================================================
def visible(element):
    if element.parent.name in ['style', 'script', '[document]', 'head', 'title']:
        return False
    elif re.match('<!--.*-->', str(element.encode('utf-8'))):
        return False
    return True

def strClean(strList):
    newRes=strList[276:-57]
    newRes2 = []
    for i in range(len(newRes)-1):
        if newRes[i+1]!='\n' and newRes[i]!='\n': 
            t1 = ' '.join(str(newRes[i]).split()) # removes the \n, which may be needed
            t1 = t1.translate(string.maketrans("",""), string.punctuation)
            newRes2.extend(str.split(t1.lower()))
    return newRes2

# ================================================================

# = Web scraper ==================================================

def main():
	baseurl = urllib.urlopen('http://www.anycountrymusiclyrics.com/').read()

	# = Get all links by artist first letter
	artistAlphaLinks = []
	for link in BeautifulSoup(baseurl, parseOnlyThese=SoupStrainer('a')):
	    if link.has_attr('href') and '.com/artist' in link['href']:
	        print link['href']
	        artistAlphaLinks.append(link['href'])

	# = Get all links of artists 
	artistLinks = []
	for alphaLink in artistAlphaLinks:    
	    newurl = urllib.urlopen(alphaLink).read()
	    for link in BeautifulSoup(newurl, parseOnlyThese=SoupStrainer('a')):
	        if link.has_attr('href') and '.com/show/artist' in link['href']:
	            print link['href']
	            artistLinks.append(link['href'])
	print(len(artistLinks))

	# = Get all links of songs 
	songLinks = []
	for artistLink in artistLinks:    
	    newArtisturl = urllib.urlopen(artistLink).read()
	    for link in BeautifulSoup(newArtisturl, parseOnlyThese=SoupStrainer('a')):
	        if link.has_attr('href') and '.com/lyrics/' in link['href']:
	            print link['href']
	            songLinks.append(link['href'])
	print(len(songLinks))

	# = Get the lyrics of all songs 
	songLyrics = []
	for songLink in songLinks:
	    songSoup = BeautifulSoup(urllib.urlopen(songLink).read())    
	    songData = songSoup.findAll(text=True)
	    songResult = filter(visible, songData)
	    songLyrics.append(strClean(songResult)) ## Extend -> one long list, append -> list length of songs

	# = dump in pickle file
	pickle.dump(songLyrics, open("songLyrics.p","wb"))

if __name__=="__main__":
	main()</pre>
		</div>
	</div>
	<p><br></p>
	<p>The web scraper picks up 443	song lyrics total, this seems like a low number only because of that is the total number of lyrics on the website, the scaper picks up all the lyrics with 100% success rate. The lyrics are then processed by sorting the lyrics into a dictionary. Specifically I count the instances of the words, and also create a nested dictionary, with the key to the outer dictionary being the lyric, and the values for each key of the outer dictionary being a dictionary with the keys being the possible words that come after the lyric, and the value being the number of instances that has occured in the total corpus. </p>
	<p>For example if we look at the value for the key: 'hotel', we get </p><pre class="brush: plain">{'room': 3, 'wall': 1, 'bed': 1, 'sign': 1, 'with': 1}</pre>.<p> This means that or all the times th word 'hotel' appears in a lyric, 3 times it was follwed by 'room', once it was followed by 'wall' , once it was followed by 'bed', once it was followed by 'sign', and once with 'with'. </p>

	<p>This analysis can be used to compute n-grams, as well as for feature-engineering in naive-Bayes classification, for example to classify various genres of music, via their lyrics. </p>
	<p><br></p>
	<h3>Python script - Country Lyric Plot</h3>
	<div data-collapse>
	      <h4> See here &#9660;</h4>
 		<div>
 			<pre class = "brush: python"># -*- coding: utf-8 -*-
"""
Created on Sat Jul  2 16:49:11 2016

@author: matt-666
"""

import matplotlib.pyplot as plt
from collections import Counter
from nltk.corpus import stopwords
import random
import pickle

# = Post-scrape ===============================================================

def main():
	# = grab from pickle file
	songLyrics = pickle.load(open("songLyrics.p", "rb"))

	# = compress into onle long list
	flatSongLyrics = [item for sublist in songLyrics for item in sublist]

	# = remove stopwords
	flatSongLyrics_noStopwords = [word for word in flatSongLyrics if word not in (stopwords.words('english'))]

	# = the word 'chorus' remains, so we remove
	flatSongLyrics_noStopwords[:]  = [x for x in flatSongLyrics_noStopwords if x != 'chorus']

	#Count all instances of words that are not stop words
	wordCount = Counter(flatSongLyrics_noStopwords)

	# = sort dictionary by value
	sortedKeys, sortedVals = [], []
	for key, value in sorted(wordCount.iteritems(), key=lambda (k,v): (v,k)):
	    sortedKeys.append(key.title())
	    sortedVals.append(value)
	# = have to reverse since the sort is in ascending order
	sortedKeys.reverse(); sortedVals.reverse()

	# = Plot in bar chart        
	plt.figure(44); plt.clf(); res = 40
	plt.bar(range(res), sortedVals[:res]/sum(sortedVals)*100., align='center')
	plt.xticks(range(res), sortedKeys[:res], rotation = 60)
	plt.xlabel('Lyric'); plt.ylabel('Count (%)')

if __name__=="__main__":
	main()</pre>
</div>
</div>
<p><br></p>
          					<div class="left">     	
              					<div class="container">
                					<div class="sideText3">
                  						<span class="line"></span>
                	  					<p></p>
                					</div>
              					</div>	   
								
         	 				</div>
      					</div>
    				</div>
				</article>
  				<!-- End Resolution 4 --> 
  
  				<!-- Resolution 5 --> 
    			<article id="five" style="background-color:#f7f7f7;">
      				<div class="center">      
      					<p><br></p>
          				<h2>Results</h2>
          				<script>
    var myChart = new Chart({...})
</script>
<canvas id="myChart" width="150" height="150"></canvas>
<script>
var ctx = document.getElementById("myChart");
ctx.width = 200;
ctx.height = 100;
var randomColorFactor = function() {
            return Math.round(Math.random() * 255);
        };
var randomColor = function() {
            return 'rgba(' + randomColorFactor() + ',' + randomColorFactor() + ',' + randomColorFactor() + ',.7)';
        };
var myChart = new Chart(ctx, {
    type: 'bar',
    data: {
        labels: ['Im', 'Like', 'Dont', 'Know', 'Got', 'Love', 'One', 'Go', 'Little', 'Well', 'Get', 'Aint', 'Gonna', 'Never', 'Back', 'Way', 'Time', 'Take', 'Said', 'See', 'Life', 'Ive', 'Yeah', 'Right', 'Baby', 'Good', 'Cant', 'Say', 'Night', 'Youre', 'Cause', 'Still', 'Let', 'Ill', 'Think', 'Theres', 'Come', 'Make', 'Oh', 'Man'],
        datasets: [{
            label: 'Count',
            data: [ 1.29607738,  1.21655024,  1.04459968,  0.99086513,  0.85330467,
			        0.81246642,  0.74153681,  0.72434175,  0.62547018,  0.62117141,
			        0.61687265,  0.58463192,  0.5631381 ,  0.55883933,  0.54809242,
			        0.54164428,  0.54164428,  0.50940355,  0.49435787,  0.49005911,
			        0.48576034,  0.47286405,  0.46641591,  0.46426652,  0.455669  ,
			        0.42987641,  0.41268135,  0.41053197,  0.41053197,  0.40193444,
			        0.40193444,  0.37614186,  0.3718431 ,  0.3718431 ,  0.36754433,
			        0.36754433,  0.36754433,  0.3589468 ,  0.35679742,  0.35679742],
            backgroundColor: 'rgba(24, 188, 156, 0.6)',
            borderColor: 'rgba(9, 74, 61, 1)',
            borderWidth: 2,
            
        }]
    },
    options: {
    	title: {
            display: true,
            text: 'Top 40 Lyric Words',
            fontSize: 22
        },
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero:true
                },
                scaleLabel: {
        			display: true,
        			labelString: 'Usage (%)',
        			fontSize: 30
      			}
            }],
            xAxes: [{
                scaleLabel: {
        			display: true,
        			labelString: 'Word',
        			fontSize: 30
      			}
            }]
        }
    }
});
</script>
<p><br></p>
<script>
    var myChart_wordcdf = new Chart({...})
</script>
<canvas id="myChart_wordcdf" width="800%" height="600px"></canvas>
<script src = "../riffCode/word_cdf.js"></script>
<p><br></p>
<p>In order to understand the context all the stop words have been removed, taken from the <a target="_blank" href = "www.nltk.org/nltk_data/">natural language toolkit</a>, and a more accurate description of the language of contry music is achieved. We find that the just 40 words are needed make up 22.48% of all lyrics, and only about 1000 words are needed to account for 80% of all words in country music. If we look at type of language of the words from the top 40 words, they are almost all heartbreak/love kind of songs, or could be used in that context. This idea is confirmed when we look at the <a target="_blank" href="http://www.radioveronica.us/classiccountry500.htm">Top 500 country songs</a>, we can see that many songs have title such as <i>"I Don't Call Him Daddy"</i> by Doug Supernaw, or <i>"We Danced"</i> by Brad Paisley, and we might be able to infer, after looking at the data our lyrics analysis, what kind of lyrics these songs may contain.</p>
<p><br></p>
<div data-collapse>
	      <h4> See here &#9660;</h4>
 		<div>
 			<pre class = "brush: python"># -*- coding: utf-8 -*-
"""
Created on Sat Jul  2 16:49:11 2016

@author: matt-666
"""

import matplotlib.pyplot as plt
from collections import Counter
from nltk.corpus import stopwords
import random
import pickle

# = Post-scrape ===============================================================

def main():
	# = grab from pickle file
	songLyrics = pickle.load(open("songLyrics.p", "rb"))

	# = compress into onle long list
	flatSongLyrics = [item for sublist in songLyrics for item in sublist]

	# = remove stopwords
	flatSongLyrics_noStopwords = [word for word in flatSongLyrics if word not in (stopwords.words('english'))]

	# = the word 'chorus' remains, so we remove
	flatSongLyrics_noStopwords[:]  = [x for x in flatSongLyrics_noStopwords if x != 'chorus']

	#Count all instances of words that are not stop words
	wordCount = Counter(flatSongLyrics_noStopwords)

	# = sort dictionary by value
	sortedKeys, sortedVals = [], []
	for key, value in sorted(wordCount.iteritems(), key=lambda (k,v): (v,k)):
	    sortedKeys.append(key.title())
	    sortedVals.append(value)
	# = have to reverse since the sort is in ascending order
	sortedKeys.reverse(); sortedVals.reverse()

	# = Plot in bar chart        
	plt.figure(44); plt.clf(); res = 40
	plt.bar(range(res), sortedVals[:res]/sum(sortedVals)*100., align='center')
	plt.xticks(range(res), sortedKeys[:res], rotation = 60)
	plt.xlabel('Lyric'); plt.ylabel('Count (%)')

if __name__=="__main__":
	main()</pre>
</div>
</div>
<p><br></p>
          				<div class="left">
							
                  				
          				</div>
          				<div class="right">
          				</div>
      				</div>
    			</article>
  				<!-- End Resolution 5 --> 

				<!-- Resolution 6 --> 
    			<article id="six">
      				<div class="center">  
						<h2>Generating Country Music Lyrics</h2>
						<p>We can take this approach further, and use a naive-Bayes approach to generate our own country music lyrics. By taking a word, we can use the nested dictionary to see what likely words follow that word. We can continue this until we get one lyric, which consists of 8-10 words. Typically, a chorus or verse consists of 4-6 lyrics. From this we can create a song. This process is similar to <a target="_blank" href="https://en.wikipedia.org/wiki/Markov_chain">Markov chains</a>, a random mathematical system in which the outcome of a state is based on the current state a system is in, and not the one that came before it. Here, the predictive text generator will only offer suggestions based on the last word entered. However this process differs from Markov chains, in that the user has to enter a word to begin with, or a random one is generated from the dictionary. </p>
						<p><br></p>
						<h3>Python script - Country Song Generator</h3>
						<div data-collapse>
	      <h4> See here &#9660;</h4>
 		<div>
 			<pre class = "brush: python"># -*- coding: utf-8 -*-
"""
Created on Sat Jul  3 19:49:21 2016

@author: matt-666
"""

import random
import pickle

# = Helper Functions =========================================================

def WeightedPick(d):
    r = random.uniform(0, sum(d.values()))
    s = 0.0
    for k, w in d.iteritems():
        s += w
        if r < s: return k
    return k

def createVerse(mydict, verseLen, lyricLen):
    robo_lyric = [random.choice(mydict.keys())] # initiliaxe with random word
    for j in range(verseLen):
        for i in range(lyricLen):
            robo_lyric.append(WeightedPick(lyricDict[robo_lyric[-1]]))
    
    for i in range(verseLen):
        robo_lyric.insert((i+1)*lyricLen+i,'\n')  
    return(' '.join(robo_lyric))

# =============================================================================

# = Post-scrape ===============================================================

def main():
	# = grab from pickle file
	songLyrics = pickle.load(open("songLyrics.p", "rb"))

	# = Country-Robo lyric machine ===============================================
	# = Uses a naive-Bayes approach to choose the likely next word to create a lyric

	# = Create dictionary of dictionary to see what words come are likely to come after each one
	lyricDict= {}
	for song in songLyrics:
	    for word in range(len(song)-1):
	        try:
	            lyricDict.setdefault(song[word], {})[song[word+1]] += 1
	        except KeyError: # if key doesnt exist
	            lyricDict.setdefault(song[word], {})[song[word+1]] = 1


	lyricLen = 10 # number of words in lyric
	chorusLen = 4  # number of lyrics in chorus/verse
	random.seed(120) # for repetibility, set alternate seed for different song

	chorus = createVerse(lyricDict, chorusLen,lyricLen)
	verse1 = createVerse(lyricDict, chorusLen,lyricLen)
	verse2 = createVerse(lyricDict, chorusLen,lyricLen)
	mySong = verse1 + '\n\r\n' + chorus + '\n\r\n' + verse2 + '\n\r\n' + chorus 
	print(mySong)

if __name__=="__main__":
	main()

# Actual Lyric '27 seconds on a party bone is the party for me' XD XD XD</pre>
</div>
</div>
<p>A typical song produced, with both chorus and verse having 4 lyrics, and 10 words per lyric, in format verse 1, chorus, verse 2, chorus.</p>
<pre class="brush: plain"> teen havin fun there are times theres at school football 
 team and there was was custommade to do nothing before 
 anywhere that it feels its the things that lullaby 
 of the chance to sing stuff we aint funny more try

 couldve lied but when i was thinking bout as long 
 as i was in her name in love me that 
 looks like a different then well ive been grand daddy 
 aint muddy and shes a little moments like hes alright now

 check every day i think its funny well this worlds 
 too much like there id like deja vu because when 
 im outta here forever in some people take it to 
 the second grade i was in the caribbean sun well that

 couldve lied but when i was thinking bout as long 
 as i was in her name in love me that 
 looks like a different then well ive been grand daddy 
 aint muddy and shes a little moments like hes alright now

</pre>
<p><br></p>
<p>To implement this better I have impletented a training model using recurrent neural networks, which can be found on my blog post <a href="../blog/RNNCountryLyrics">here</a>, that more accurately recreates the gramatical syntax of country music lyrics.</p>
<p><br></p>
          				<div class="left">
            				<p></p> 
            				<div class="container">
               					<div class="sideText5">
                  					<span class="line"></span>
                	 				<p></p>
                				</div>
            				</div>	
      						<p></p>
        				</div>
          				<div class="right">
        				</div> 
       				</div>       
    			</article>
    			<!-- End Resolution 6 --> 

				<!-- Resolution 7 -->  
    			<article id="seven" style="background-color:#f7f7f7; padding-bottom: 0;">	 
					<div class="center">
						<p><br></p>
          				<h2>Conclusion</h2>	
          				<p>To conclude, we have seen that while chord progressions show as much variation as other genres, there is significantly less variation in the actual chords used in the chord progressions that may lead to the reason I believe that many country music sounds similar. Also, the language used in country music has little variation and the theme of the songs is also similar, and generated lyrics, if we take grammar out, is pretty convincing, and subscribes to the successful <i>"formula"</i> that has dominated country music.</p>
						<p>In the end it's not just me that thinks all country music sounds the same, as Buzzfeed <a target="_blank" href="https://www.buzzfeed.com/maycie/this-video-proves-that-all-country-music-sounds-the-same?utm_term=.sl3kkr2QA#.cr5gg4ERe">reports</a>, song writer Gregory Todd <a target="_blank" href="https://www.youtube.com/channel/UCviDRYUvXRn7m9UrEx_nnVg">shows</a> that different country songs, from differnt artists, can be mixed the result can be seemless. </p>
						<p><br></p>
					         				<div style="clear:both;"></div>	
          				
      				</div>   	
    			</article>
  				<!-- End Resolution 7 --> 
  	
				<!-- Resolution 8 -->  
    			<article id="eight">
      				<div class="center">	
              			<h2></h2>	     
              			<div class="left"> 	
                			<div class="container">
                				<div class="sideText4">
                  					<span class="line"></span>
                		  			<p></p>
                				</div>
              				</div>	  
      						<p></p>
            			</div>
              			<div class="right">
              			</div>  
              			<div style="clear: both;"></div>
                     </div> 
              		 <div class="center">
              		</div>  	
    			</article>
  				<!-- End Resolution 8 --> 
	
    			<!-- Resolution 9-->      
    			<article id="forecast" style=" display: block; margin-bottom: 0px; ">
      					<div class="center"> 
              				<h2>Other Projects</h2>        
              				<p><br></p>
              				<p><br></p>
              				<p><br></p>
              				<p><br></p>
              				<p><br></p>
              				<p><br></p>
              				<p><br></p>
              				<p><br></p>
              				<p class style="font-style: italic; margin-bottom: 33px;">
      					</div>
      				
    			</article>
    			<!-- End Resolution 9 --> 
              
        	</div> <!--extra wrapper-->
         	<footer class="text-center">
        <div class="footer-below">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <h4>Matthew Moocarme - moocarme@gmail.com</h4>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    	</div><!-- end wrapper -->
 	<script type="text/javascript" src="//munchkin.marketo.net//munchkin-beta.js"></script><script>Munchkin.init('062-HAC-076', {customName: 'past-forward-2016', wsInfo: 'j1RR'});</script>
 	</body>


<style>
#mktoForm_375 {
    width: auto!important;
}
</style>
<script type="text/javascript">
     SyntaxHighlighter.all()
</script>
<script>
$(document).ready(function() {
  
    
  
	var sections = $('article'), 
        nav = $('nav'), 
        nav_height = nav.outerHeight();
 
	$(window).on('scroll', function () {

  		var cur_pos = $(this).scrollTop();
 
  		sections.each(function() {
    	var top = $(this).offset().top - nav_height,
        bottom = top + $(this).outerHeight();
 
    	if (cur_pos >= top && cur_pos <= bottom) {
      		nav.find('a').removeClass('active');
      		sections.removeClass('active');
 
      		$(this).addClass('active');
      		nav.find('a[href="/examples/SmoothPageScroll/#'+$(this).attr('id')+'"]').addClass('active');
    	}
  		});
      
      	if ($('#one .left').isOnScreen()) {
    		var wScroll = $(this).scrollTop();
          	var $sideText1 = $('.sideText1');
            var containerScroll = wScroll - $sideText1.parent().offset().top + 1000;
      		$sideText1.css({
       			'transform' : 'translate(0px, +'+ containerScroll/10 +'%)' 
      		});  
      	}
      	
      	if ($('#two .left').isOnScreen()) {
    		var wScroll = $(this).scrollTop();
          	var $sideText2 = $('.sideText2');
          	var containerScroll2 = wScroll - $sideText2.parent().offset().top + 1000;
      		$sideText2.css({
       			'transform' : 'translate(0px, +'+ containerScroll2/10 +'%)' 
      		});  
      	}
      	
      	 if ($('#four .left').isOnScreen()) {
    		var wScroll = $(this).scrollTop();
          	var $sideText3 = $('.sideText3');
          	var containerScroll3 = wScroll - $sideText3.parent().offset().top + 1000;
      		$sideText3.css({
       			'transform' : 'translate(0px, +'+ containerScroll3/10 +'%)' 
      		});  
      	}
      
      	if ($('#eight .left').isOnScreen()) {
    		var wScroll = $(this).scrollTop();
          	var $sideText4 = $('.sideText4');
          	var containerScroll4 = wScroll - $sideText4.parent().offset().top + 1000;
      		$sideText4.css({
       			'transform' : 'translate(0px, +'+ containerScroll4/10 +'%)' 
      		});  
      	}
      
      	if ($('#six .left').isOnScreen()) {
    		var wScroll = $(this).scrollTop();
          	var $sideText5 = $('.sideText5');
          	var containerScroll5 = wScroll - $sideText5.parent().offset().top + 1000;
      		$sideText5.css({
       			'transform' : 'translate(0px, +'+ containerScroll5/10 +'%)' 
      		});  
      	}
      
      	/** Measures the height of hero then nav bar appears after it **/
      	var heroHeight = $('.hero').height();
      
      	if ($(this).scrollTop() > heroHeight) {
          $('.nav-toggle').addClass('show');
        } else {
           $('.nav-toggle').removeClass('show');
        }

      	/** For Desktop Nav only (from 1170px wide) **/
      	if ($(this).scrollTop() > heroHeight){ 
    		$('#desktopNav').addClass('fixedElement'); 
  		} else {
    		$('#desktopNav').removeClass('fixedElement'); 
  		}	
	});  
  
  	/**** Smooth Scrolling ****/
	$('a[href*=#]:not([href=#])').click(function() {
    	if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') 
        	|| location.hostname == this.hostname) {

        	var target = $(this.hash);
        	target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
           	if (target.length) {
            	$('html,body').animate({
                	scrollTop: target.offset().top
            	}, 1000);
            	return false;
        	}
    	}
	});
  	
  	
}); 

  
  /*** Navigation menu toggle ***/
  $('.nav-toggle').on('click', function(){
    $('.wrapper').toggleClass('open');
    $('.main-navigation-left').toggleClass('open');
    $('.nav-toggle').toggleClass('open');
  });
  
  /*Desktop Fixed Nav*/
  var stickyTop = $('#desktopNav').offset().top;
  
  
  /** Function to see when a div is in view **/
  $.fn.isOnScreen = function(){
    var win = $(window);
    var viewport = {
        top : win.scrollTop(),
        left : win.scrollLeft()
    };
    
    viewport.right = viewport.left + win.width();
    viewport.bottom = viewport.top + win.height();
    
    var bounds = this.offset();
    bounds.right = bounds.left + this.outerWidth();
    bounds.bottom = bounds.top + this.outerHeight();
    
    return (!(viewport.right < bounds.left || viewport.left > bounds.right || viewport.bottom < bounds.top || viewport.top > bounds.bottom));
  };
</script></html>
